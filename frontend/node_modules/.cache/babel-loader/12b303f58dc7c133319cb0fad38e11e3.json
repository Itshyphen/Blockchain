{"ast":null,"code":"import _regeneratorRuntime from\"/home/ranju/location/meDossier/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/ranju/location/meDossier/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/ranju/location/meDossier/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import Web3 from\"web3\";import{withStyles}from\"@material-ui/core/styles\";import{Table,TableHead,TableContainer,TableBody,TableCell,TableRow,Card,Box,Paper,TextField,Button}from\"@material-ui/core\";import{Tab,Row,Col,Nav}from\"react-bootstrap\";import\"./general.css\";import logo from\"./logo.png\";import{CONTRACT_ADDRESS,ABI}from\"../config.js\";import ipfs from\"../ipfs.js\";import history from\"./history\";//main dashboard\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function DocDashboard(props){// const [currentAccount, setCurrentAccount] = useState(props.currentAccount);\n// const[contract, setContract] = useState(props.contract);\nvar _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),phone=_useState4[0],setPhone=_useState4[1];var _useState5=useState(\"Female\"),_useState6=_slicedToArray(_useState5,2),gender=_useState6[0],setGender=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),dob=_useState8[0],setDob=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),blood=_useState10[0],setBlood=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),accountAddr=_useState12[0],setAccountAddr=_useState12[1];var _useState13=useState(\"false\"),_useState14=_slicedToArray(_useState13,2),authorized=_useState14[0],isAuthorized=_useState14[1];var _useState15=useState(0),_useState16=_slicedToArray(_useState15,2),recordlen=_useState16[0],setRecordLength=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),records=_useState18[0],setRecords=_useState18[1];var _useState19=useState(\"\"),_useState20=_slicedToArray(_useState19,2),dname=_useState20[0],setDname=_useState20[1];var _useState21=useState(\"\"),_useState22=_slicedToArray(_useState21,2),visitedDate=_useState22[0],setVisDate=_useState22[1];var _useState23=useState(\"\"),_useState24=_slicedToArray(_useState23,2),reason=_useState24[0],setReason=_useState24[1];var _useState25=useState(null),_useState26=_slicedToArray(_useState25,2),buffer=_useState26[0],setBuffer=_useState26[1];//get the data from local storage\nvar docname=localStorage.getItem(\"docname\");var faculty=localStorage.getItem(\"faculty\");var license=localStorage.getItem(\"license\");var hname=localStorage.getItem(\"hname\");var isApproved=localStorage.getItem(\"isApproved\");var contact=localStorage.getItem(\"contact\");var currentAccount=localStorage.getItem(\"currentAccount\");var web3=new Web3(Web3.givenProvider);var contract=new web3.eth.Contract(ABI,CONTRACT_ADDRESS);var ispatient=localStorage.getItem(\"ispatient\");var isAdmin=localStorage.getItem(\"isUser\");//Get details of patient: can be accessed by anyone\nvar getPatientDetails=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return contract.methods.getPatientDetails(accountAddr).call();case 3:result=_context.sent;console.log(result);setName(result[\"_name\"]);setPhone(result[\"_phone\"]);setBlood(result[\"_bloodgroup\"]);setGender(result[\"_gender\"]);setDob(result[\"_dob\"]);_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 15:getPatientRecord();case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,12]]);}));return function getPatientDetails(_x){return _ref.apply(this,arguments);};}();//bullet tube vague brain excuse valley total whale scrap sense water unfold\n//Get access to the patient record: only to authorized doctor\nvar getPatientRecord=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var access,rlen,record,i,result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return contract.methods.isAuthorized(accountAddr,currentAccount).call();case 3:access=_context2.sent;console.log(access);isAuthorized(access);//get the number of records\n_context2.next=8;return contract.methods.getrecordlist(accountAddr).call();case 8:rlen=_context2.sent;console.log(rlen);setRecordLength(rlen);if(!authorized){_context2.next=27;break;}record=[];i=0;case 14:if(!(i<recordlen)){_context2.next=23;break;}_context2.next=17;return contract.methods.getPatientRecords(accountAddr,i).call({from:currentAccount});case 17:result=_context2.sent;console.log(result);record.push({dname:result.dname,reason:result.reason,visDate:result.visitedDate,ipfs:result.ipfs});case 20:i++;_context2.next=14;break;case 23:console.log(record);setRecords(record);_context2.next=28;break;case 27:alert(\"Sorry! You are not authorized to get the whole record.\");case 28:_context2.next=33;break;case 30:_context2.prev=30;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 33:case\"end\":return _context2.stop();}}},_callee2,null,[[0,30]]);}));return function getPatientRecord(_x2){return _ref2.apply(this,arguments);};}();//Only authorized doctor can add the patients record\nvar addPatientRecord=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var access,ipfshash,url,hash;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return contract.methods.isAuthorized(accountAddr,currentAccount).call();case 3:access=_context3.sent;console.log(access);isAuthorized(access);if(!authorized){_context3.next=18;break;}_context3.next=9;return ipfs.files.add(buffer);case 9:ipfshash=_context3.sent;//url ro the ipfs stored file\nurl=\"https://ipfs.io/ipfs/\"+ipfshash[0].hash;console.log(ipfshash[0].hash);console.log(url.toString());// ipfshash[0].hash.toString()\nhash=ipfshash[0].hash;// const hashs = String(hash)\n_context3.next=16;return contract.methods.addRecord(docname,reason,visitedDate,String(hash),accountAddr).send({from:currentAccount,gas:1000000});case 16:_context3.next=19;break;case 18:alert(\"Sorry! You are not authorized to get the whole record.\");case 19:_context3.next=25;break;case 21:_context3.prev=21;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);alert(\"Error Uploading Report\");case 25:case\"end\":return _context3.stop();}}},_callee3,null,[[0,21]]);}));return function addPatientRecord(_x3){return _ref3.apply(this,arguments);};}();//Get the uploaded file and set its buffer\nvar captureFile=function captureFile(event){event.stopPropagation();event.preventDefault();var file=event.target.files[0];var reader=new window.FileReader();reader.readAsArrayBuffer(file);reader.onload=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var buffer;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return Buffer.from(reader.result);case 2:buffer=_context4.sent;setBuffer(buffer);case 4:case\"end\":return _context4.stop();}}},_callee4);}));};//Styling for table cell\nvar StyledTableCell=withStyles(function(theme){return{head:{backgroundColor:theme.palette.info.main,color:theme.palette.common.blue},body:{fontSize:14}};})(TableCell);var StyledTableRow=withStyles(function(theme){return{root:{\"&:nth-of-type(odd)\":{backgroundColor:theme.palette.action.hover}}};})(TableRow);if(!currentAccount){history.push(\"/\");}if(ispatient==\"true\"){history.push(\"/patient\");}if(isAdmin==\"true\"){history.push(\"/Registration_office\");}return/*#__PURE__*/_jsxs(\"div\",{className:\"DocDashboard\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"navbar\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"/doctor_dashboard\",children:/*#__PURE__*/_jsx(Button,{o:true,children:/*#__PURE__*/_jsx(\"img\",{src:logo,width:\"120\",height:\"40\",className:\"d-inline-block align-top\",alt:\"React Bootstrap logo\"})})}),/*#__PURE__*/_jsxs(Button,{onClick:function onClick(e){return props.logout();},children:[\" \",/*#__PURE__*/_jsx(\"i\",{class:\"fas fa-1x fa-sign-out-alt\"}),\" Log out\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"tab-wrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container-fluid\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-12\",children:/*#__PURE__*/_jsx(Tab.Container,{defaultActiveKey:\"your_details\",children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{sm:3,children:/*#__PURE__*/_jsxs(Nav,{variant:\"pills\",className:\"flex-column\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Nav.Item,{children:/*#__PURE__*/_jsx(Nav.Link,{eventKey:\"your_details\",children:\"My Details\"})})}),/*#__PURE__*/_jsx(Nav.Item,{children:/*#__PURE__*/_jsx(Nav.Link,{eventKey:\"access_record\",children:\"Access Records\"})}),/*#__PURE__*/_jsx(Nav.Item,{children:/*#__PURE__*/_jsx(Nav.Link,{eventKey:\"add_record\",children:\"Add Records\"})})]})}),/*#__PURE__*/_jsx(Col,{sm:9,children:/*#__PURE__*/_jsxs(Tab.Content,{children:[/*#__PURE__*/_jsxs(Tab.Pane,{eventKey:\"your_details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"Details\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"....Welcome to the meDossier....\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"..This is the place where you can access your patients records anywhere everywhere..\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Your Details\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"b\",{children:[\"Account Address:\",/*#__PURE__*/_jsx(\"span\",{children:currentAccount})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"details\",children:[/*#__PURE__*/_jsxs(\"b\",{children:[\"Name :\",/*#__PURE__*/_jsx(\"span\",{children:docname})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"b\",{children:[\"License Number :\",/*#__PURE__*/_jsx(\"span\",{children:license})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"b\",{children:[\"Hospital Name :\",/*#__PURE__*/_jsx(\"span\",{children:hname})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"b\",{children:[\"Faculty :\",/*#__PURE__*/_jsx(\"span\",{children:faculty})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"b\",{children:[\"Contact :\",/*#__PURE__*/_jsx(\"span\",{children:contact})]}),/*#__PURE__*/_jsx(\"br\",{})]})]})]}),/*#__PURE__*/_jsxs(Tab.Pane,{eventKey:\"access_record\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"Details\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"....Welcome to the meDossier....\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"..Before you access the records, ask the patient for the permission..\"})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"small card\",children:[/*#__PURE__*/_jsx(\"h5\",{children:/*#__PURE__*/_jsx(\"b\",{children:\"Enter the address of Patient:\"})}),/*#__PURE__*/_jsx(TextField,{id:\"outlined-basic full-width\",fullWidth:true,variant:\"outlined\",margin:\"normal\",label:\"Patient Account Address\",onChange:function onChange(e){return setAccountAddr(e.target.value);}}),/*#__PURE__*/_jsx(Button,{onClick:getPatientDetails,variant:\"contained\",style:{backgroundColor:\"#0080FF\",color:\"floralwhite\",height:\"10\",alignSelf:\"end\"},children:\"Get Record\"})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"small card\",children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Patient Name: \"}),/*#__PURE__*/_jsx(\"b\",{children:\"Account Address:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"smallcard\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Name:\",name,\"\\t\\t\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Phone:\",phone]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"DoB:\",dob]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Gender:\",gender]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Blood Group:\",blood]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"table\",children:/*#__PURE__*/_jsx(Box,{mt:3,mb:3,children:/*#__PURE__*/_jsx(TableContainer,{component:Paper,children:/*#__PURE__*/_jsxs(Table,{size:\"small\",children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(StyledTableCell,{children:\"Doctor Name\"}),/*#__PURE__*/_jsx(StyledTableCell,{children:\"Reason\"}),/*#__PURE__*/_jsx(StyledTableCell,{children:\"Visited Date\"}),/*#__PURE__*/_jsx(StyledTableCell,{children:\"Report\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:records.map(function(record,index){return/*#__PURE__*/_jsxs(StyledTableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:record[\"dname\"]}),/*#__PURE__*/_jsx(TableCell,{children:record[\"reason\"]}),/*#__PURE__*/_jsx(TableCell,{children:record[\"visDate\"]}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(\"a\",{href:\"https://ipfs.io/ipfs/\"+record[\"ipfs\"],target:\"_blrowank\",children:\"View/Download Record\"})})]},index);})})]})})})})]})]}),/*#__PURE__*/_jsxs(Tab.Pane,{eventKey:\"add_record\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"Details\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"....Welcome to the meDossier....\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"..Upload the new records of your patients..\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Add Records\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(TextField,{id:\"outlined-basic full-width\",fullWidth:true,variant:\"outlined\",margin:\"normal\",label:\"Patient Account Address\",onChange:function onChange(e){return setAccountAddr(e.target.value);}}),/*#__PURE__*/_jsx(TextField,{id:\"outlined-basic\",fullWidth:true,variant:\"outlined\",margin:\"normal\",label:\"Doctor Name\",value:docname,onChange:function onChange(e){return setDname({docname:docname});}}),/*#__PURE__*/_jsx(TextField,{id:\"outlined-basic\",fullWidth:true,variant:\"outlined\",margin:\"normal\",label:\"Visit Reason\",onChange:function onChange(e){return setReason(e.target.value);}}),/*#__PURE__*/_jsx(TextField,{id:\"outlined-basic\",fullWidth:true,variant:\"outlined\",margin:\"normal\",type:\"date\",label:\"Visited Date\",onChange:function onChange(e){return setVisDate(e.target.value);},InputLabelProps:{shrink:true}}),/*#__PURE__*/_jsx(TextField,{type:\"file\",label:\"Report\",fullWidth:true,margin:\"normal\",InputLabelProps:{shrink:true},onChange:captureFile}),/*#__PURE__*/_jsx(Button,{onClick:addPatientRecord,variant:\"contained\",fullWidth:true,margin:\"normal\",style:{backgroundColor:\"#0080FF\",color:\"floralwhite\"},children:\"Add Record\"})]})]})]})]})})]})})})})})})]});}export default DocDashboard;//Check the functions of the contract\n// const gas = await contract.methods.addPatient(\"name\",\"hname\",\"contact\",\"faculty\",\"blue\").estimateGas();\n// const result = await contract.methods.addPatient(\"name\",\"hname\",\"contact\",\"faculty\",\"blue\").send({from: currentAccount, gas: 1000000});\n// const gas = await contract.methods.addDoctor(\"name\",\"hname\",\"contact\",\"faculty\").estimateGas();\n// const result = await contract.methods.addDoctor(\"name\",\"hname\",\"contact\",\"faculty\").send({from: currentAccount, gas: 1000000}); // const gas = await contract.methods.grantAccess(\"0xAb5d5d8C5E257d35E41f955693b42d628C126A2E\").estimateGas();\n// const result = await contract.methods.grantAccess(\"0xc52Bb0B6A662859B2E182524585b2F0a676F7823\").send({from: currentAccount,gas:1000000});\n// console.log(result)\n// const gas = await contract.methods.grantAccess(\"0xAb5d5d8C5E257d35E41f955693b42d628C126A2E\").estimateGas();\n// const result = await contract.methods.grantAccess(\"0xc52Bb0B6A662859B2E182524585b2F0a676F7823\").send({from: currentAccount,gas:1000000});\n// console.log(result)","map":{"version":3,"sources":["/home/ranju/location/meDossier/frontend/src/pages/doctor_dashboard.js"],"names":["React","useState","Web3","withStyles","Table","TableHead","TableContainer","TableBody","TableCell","TableRow","Card","Box","Paper","TextField","Button","Tab","Row","Col","Nav","logo","CONTRACT_ADDRESS","ABI","ipfs","history","DocDashboard","props","name","setName","phone","setPhone","gender","setGender","dob","setDob","blood","setBlood","accountAddr","setAccountAddr","authorized","isAuthorized","recordlen","setRecordLength","records","setRecords","dname","setDname","visitedDate","setVisDate","reason","setReason","buffer","setBuffer","docname","localStorage","getItem","faculty","license","hname","isApproved","contact","currentAccount","web3","givenProvider","contract","eth","Contract","ispatient","isAdmin","getPatientDetails","e","methods","call","result","console","log","getPatientRecord","access","getrecordlist","rlen","record","i","getPatientRecords","from","push","visDate","alert","addPatientRecord","files","add","ipfshash","url","hash","toString","addRecord","String","send","gas","captureFile","event","stopPropagation","preventDefault","file","target","reader","window","FileReader","readAsArrayBuffer","onload","Buffer","StyledTableCell","theme","head","backgroundColor","palette","info","main","color","common","blue","body","fontSize","StyledTableRow","root","action","hover","logout","value","height","alignSelf","map","index","shrink"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport Web3 from \"web3\";\nimport { withStyles } from \"@material-ui/core/styles\";\nimport {\n  Table,\n  TableHead,\n  TableContainer,\n  TableBody,\n  TableCell,\n  TableRow,\n  Card,\n  Box,\n  Paper,\n  TextField,\n  Button,\n} from \"@material-ui/core\";\nimport { Tab, Row, Col, Nav } from \"react-bootstrap\";\nimport \"./general.css\";\nimport logo from \"./logo.png\";\nimport { CONTRACT_ADDRESS, ABI } from \"../config.js\";\nimport ipfs from \"../ipfs.js\";\nimport history from \"./history\";\n\n//main dashboard\nfunction DocDashboard(props) {\n  // const [currentAccount, setCurrentAccount] = useState(props.currentAccount);\n  // const[contract, setContract] = useState(props.contract);\n  const [name, setName] = useState(\"\");\n  const [phone, setPhone] = useState(\"\");\n  const [gender, setGender] = useState(\"Female\");\n  const [dob, setDob] = useState(\"\");\n  const [blood, setBlood] = useState(\"\");\n  const [accountAddr, setAccountAddr] = useState(\"\");\n  const [authorized, isAuthorized] = useState(\"false\");\n  const [recordlen, setRecordLength] = useState(0);\n  const [records, setRecords] = useState([]);\n  const [dname, setDname] = useState(\"\");\n  const [visitedDate, setVisDate] = useState(\"\");\n  const [reason, setReason] = useState(\"\");\n  const [buffer, setBuffer] = useState(null);\n\n  //get the data from local storage\n  const docname = localStorage.getItem(\"docname\");\n  const faculty = localStorage.getItem(\"faculty\");\n  const license = localStorage.getItem(\"license\");\n  const hname = localStorage.getItem(\"hname\");\n  const isApproved = localStorage.getItem(\"isApproved\");\n  const contact = localStorage.getItem(\"contact\");\n  const currentAccount = localStorage.getItem(\"currentAccount\");\n\n  const web3 = new Web3(Web3.givenProvider);\n  const contract = new web3.eth.Contract(ABI, CONTRACT_ADDRESS);\n\n  const ispatient = localStorage.getItem(\"ispatient\");\n  const isAdmin = localStorage.getItem(\"isUser\");\n\n  //Get details of patient: can be accessed by anyone\n  const getPatientDetails = async (e) => {\n    try {\n      const result = await contract.methods\n        .getPatientDetails(accountAddr)\n        .call();\n      console.log(result);\n      setName(result[\"_name\"]);\n      setPhone(result[\"_phone\"]);\n      setBlood(result[\"_bloodgroup\"]);\n      setGender(result[\"_gender\"]);\n      setDob(result[\"_dob\"]);\n    } catch (error) {\n      console.log(error);\n    }\n    getPatientRecord();\n  };\n  //bullet tube vague brain excuse valley total whale scrap sense water unfold\n\n  //Get access to the patient record: only to authorized doctor\n  const getPatientRecord = async (e) => {\n    try {\n      //check whether doctor is authorized or not\n      const access = await contract.methods\n        .isAuthorized(accountAddr, currentAccount)\n        .call();\n      console.log(access);\n      isAuthorized(access);\n\n      //get the number of records\n      const rlen = await contract.methods.getrecordlist(accountAddr).call();\n      console.log(rlen);\n      setRecordLength(rlen);\n\n      if (authorized) {\n        let record = [];\n        for (var i = 0; i < recordlen; i++) {\n          const result = await contract.methods\n            .getPatientRecords(accountAddr, i)\n            .call({ from: currentAccount });\n          console.log(result);\n          record.push({\n            dname: result.dname,\n            reason: result.reason,\n            visDate: result.visitedDate,\n            ipfs: result.ipfs,\n          });\n        }\n        console.log(record);\n        setRecords(record);\n      } else {\n        alert(\"Sorry! You are not authorized to get the whole record.\");\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  //Only authorized doctor can add the patients record\n  const addPatientRecord = async (e) => {\n    try {\n      //whether doctor is authorized or not\n      const access = await contract.methods\n        .isAuthorized(accountAddr, currentAccount)\n        .call();\n      console.log(access);\n      isAuthorized(access);\n\n      if (authorized) {\n        //add the file buffer to ipfs\n        let ipfshash = await ipfs.files.add(buffer);\n        //url ro the ipfs stored file\n        let url = \"https://ipfs.io/ipfs/\" + ipfshash[0].hash;\n        console.log(ipfshash[0].hash);\n        console.log(url.toString());\n        // ipfshash[0].hash.toString()\n        const hash = ipfshash[0].hash;\n        // const hashs = String(hash)\n\n        await contract.methods\n          .addRecord(docname, reason, visitedDate, String(hash), accountAddr)\n          .send({ from: currentAccount, gas: 1000000 });\n      } else {\n        alert(\"Sorry! You are not authorized to get the whole record.\");\n      }\n    } catch (error) {\n      console.log(error);\n      alert(\"Error Uploading Report\");\n    }\n  };\n\n  //Get the uploaded file and set its buffer\n  const captureFile = (event) => {\n    event.stopPropagation();\n    event.preventDefault();\n    const file = event.target.files[0];\n    let reader = new window.FileReader();\n    reader.readAsArrayBuffer(file);\n    reader.onload = async () => {\n      const buffer = await Buffer.from(reader.result);\n      setBuffer(buffer);\n    };\n  };\n\n  //Styling for table cell\n  const StyledTableCell = withStyles((theme) => ({\n    head: {\n      backgroundColor: theme.palette.info.main,\n      color: theme.palette.common.blue,\n    },\n    body: {\n      fontSize: 14,\n    },\n  }))(TableCell);\n\n  const StyledTableRow = withStyles((theme) => ({\n    root: {\n      \"&:nth-of-type(odd)\": {\n        backgroundColor: theme.palette.action.hover,\n      },\n    },\n  }))(TableRow);\n\n  if (!currentAccount) {\n    history.push(\"/\");\n  }\n  if (ispatient == \"true\") {\n    history.push(\"/patient\");\n  }\n  if (isAdmin == \"true\") {\n    history.push(\"/Registration_office\");\n  }\n\n  return (\n    <div className=\"DocDashboard\">\n      {/* Navbar */}\n      <div className=\"navbar\">\n        <a href=\"/doctor_dashboard\">\n          <Button o>\n            <img\n              src={logo}\n              width=\"120\"\n              height=\"40\"\n              className=\"d-inline-block align-top\"\n              alt=\"React Bootstrap logo\"\n            />\n          </Button>\n        </a>\n\n        {/* <Button a href=\"/doctor_dashboard\" > <i class=\"fas fa-1x fa-user-circle\"></i> {docname}  </Button> */}\n\n        <Button onClick={(e) => props.logout()}>\n          {\" \"}\n          <i class=\"fas fa-1x fa-sign-out-alt\" /> Log out\n        </Button>\n      </div>\n      {/* End Navbar */}\n\n      {/* Side Tabs */}\n      <div className=\"tab-wrapper\">\n        <div className=\"container-fluid\">\n          <div className=\"row\">\n            <div className=\"col-sm-12\">\n              <Tab.Container defaultActiveKey=\"your_details\">\n                <Row>\n                  <Col sm={3}>\n                    <Nav variant=\"pills\" className=\"flex-column\">\n                      <div>\n                        <Nav.Item>\n                          <Nav.Link eventKey=\"your_details\">\n                            My Details\n                          </Nav.Link>\n                        </Nav.Item>\n                      </div>\n\n                      <Nav.Item>\n                        <Nav.Link eventKey=\"access_record\">\n                          Access Records\n                        </Nav.Link>\n                      </Nav.Item>\n\n                      <Nav.Item>\n                        <Nav.Link eventKey=\"add_record\">Add Records</Nav.Link>\n                      </Nav.Item>\n                    </Nav>\n                  </Col>\n                  <Col sm={9}>\n                    <Tab.Content>\n                      {/* Doctors Details */}\n                      <Tab.Pane eventKey=\"your_details\">\n                        <div className=\"Details\">\n                          <h4>....Welcome to the meDossier....</h4>\n                          <h4>\n                            ..This is the place where you can access your\n                            patients records anywhere everywhere..\n                          </h4>\n                        </div>\n                        <div className=\"card\">\n                          <h3>Your Details</h3>\n                          <hr></hr>\n                          <div>\n                            <b>\n                              Account Address:<span>{currentAccount}</span>\n                            </b>\n                          </div>\n                          <div className=\"details\">\n                            <b>\n                              Name :<span>{docname}</span>\n                            </b>\n                            <br></br>\n                            <b>\n                              License Number :<span>{license}</span>\n                            </b>\n                            <br></br>\n                            <b>\n                              Hospital Name :<span>{hname}</span>\n                            </b>\n                            <br></br>\n                            <b>\n                              Faculty :<span>{faculty}</span>\n                            </b>\n                            <br />\n                            <b>\n                              Contact :<span>{contact}</span>\n                            </b>\n                            <br></br>\n                          </div>\n                        </div>\n                      </Tab.Pane>\n                      {/* End Doctor Details */}\n\n                      {/* Access Record Tab*/}\n                      <Tab.Pane eventKey=\"access_record\">\n                        <div className=\"Details\">\n                          <h4>....Welcome to the meDossier....</h4>\n                          <h4>\n                            ..Before you access the records, ask the patient for\n                            the permission..\n                          </h4>\n                        </div>\n                        {/* Enter Address Container */}\n                        <div class=\"small card\">\n                          <h5>\n                            <b>Enter the address of Patient:</b>\n                          </h5>\n                          <TextField\n                            id=\"outlined-basic full-width\"\n                            fullWidth\n                            variant=\"outlined\"\n                            margin=\"normal\"\n                            label=\"Patient Account Address\"\n                            onChange={(e) => setAccountAddr(e.target.value)}\n                          />\n                          <Button\n                            onClick={getPatientDetails}\n                            variant=\"contained\"\n                            style={{\n                              backgroundColor: \"#0080FF\",\n                              color: \"floralwhite\",\n                              height: \"10\",\n                              alignSelf: \"end\",\n                            }}\n                          >\n                            Get Record\n                          </Button>\n                        </div>\n                        {/* End Enter Address Container */}\n\n                        {/* Patient Details */}\n                        <div class=\"small card\">\n                          <Card>\n                            <h4>Patient Name: </h4>\n                            <b>Account Address:</b>\n                            <div className=\"smallcard\">\n                              <div>\n                                Name:{name}\n                                {\"\\t\\t\"}\n                              </div>\n                              <div>Phone:{phone}</div>\n                              <div>DoB:{dob}</div>\n                              <div>Gender:{gender}</div>\n                              <div>Blood Group:{blood}</div>\n                            </div>\n                          </Card>\n\n                          <div className=\"table\">\n                            <Box mt={3} mb={3}>\n                              <TableContainer component={Paper}>\n                                <Table size={\"small\"}>\n                                  <TableHead>\n                                    <TableRow>\n                                      <StyledTableCell>\n                                        Doctor Name\n                                      </StyledTableCell>\n                                      <StyledTableCell>Reason</StyledTableCell>\n                                      <StyledTableCell>\n                                        Visited Date\n                                      </StyledTableCell>\n                                      <StyledTableCell>Report</StyledTableCell>\n                                    </TableRow>\n                                  </TableHead>\n                                  <TableBody>\n                                    {records.map((record, index) => {\n                                      return (\n                                        <StyledTableRow key={index}>\n                                          <TableCell>\n                                            {record[\"dname\"]}\n                                          </TableCell>\n                                          <TableCell>\n                                            {record[\"reason\"]}\n                                          </TableCell>\n                                          <TableCell>\n                                            {record[\"visDate\"]}\n                                          </TableCell>\n                                          <TableCell>\n                                            <a\n                                              href={\n                                                \"https://ipfs.io/ipfs/\" +\n                                                record[\"ipfs\"]\n                                              }\n                                              target=\"_blrowank\"\n                                            >\n                                              View/Download Record\n                                            </a>\n                                          </TableCell>\n                                        </StyledTableRow>\n                                      );\n                                    })}\n                                  </TableBody>\n                                </Table>\n                              </TableContainer>\n                            </Box>\n                          </div>\n                        </div>\n                        {/* End Patient Details */}\n\n                        {/* view patient records */}\n\n                        {/* End Patient Record */}\n                      </Tab.Pane>\n                      {/* End Access Record */}\n\n                      {/* Add Record */}\n                      <Tab.Pane eventKey=\"add_record\">\n                        <div className=\"Details\">\n                          <h4>....Welcome to the meDossier....</h4>\n                          <h4>..Upload the new records of your patients..</h4>\n                        </div>\n                        <div className=\"card\">\n                          <h3>Add Records</h3>\n                          <hr></hr>\n                          <form>\n                            <TextField\n                              id=\"outlined-basic full-width\"\n                              fullWidth\n                              variant=\"outlined\"\n                              margin=\"normal\"\n                              label=\"Patient Account Address\"\n                              onChange={(e) => setAccountAddr(e.target.value)}\n                            />\n                            <TextField\n                              id=\"outlined-basic\"\n                              fullWidth\n                              variant=\"outlined\"\n                              margin=\"normal\"\n                              label=\"Doctor Name\"\n                              value={docname}\n                              onChange={(e) => setDname({ docname })}\n                            />\n                            <TextField\n                              id=\"outlined-basic\"\n                              fullWidth\n                              variant=\"outlined\"\n                              margin=\"normal\"\n                              label=\"Visit Reason\"\n                              onChange={(e) => setReason(e.target.value)}\n                            ></TextField>\n                            <TextField\n                              id=\"outlined-basic\"\n                              fullWidth\n                              variant=\"outlined\"\n                              margin=\"normal\"\n                              type=\"date\"\n                              label=\"Visited Date\"\n                              onChange={(e) => setVisDate(e.target.value)}\n                              InputLabelProps={{ shrink: true }}\n                            ></TextField>\n                            <TextField\n                              type=\"file\"\n                              label=\"Report\"\n                              fullWidth\n                              margin=\"normal\"\n                              InputLabelProps={{ shrink: true }}\n                              onChange={captureFile}\n                            ></TextField>\n                            <Button\n                              onClick={addPatientRecord}\n                              variant=\"contained\"\n                              fullWidth\n                              margin=\"normal\"\n                              style={{\n                                backgroundColor: \"#0080FF\",\n                                color: \"floralwhite\",\n                              }}\n                            >\n                              Add Record\n                            </Button>\n                          </form>\n                        </div>\n                      </Tab.Pane>\n                    </Tab.Content>\n                  </Col>\n                </Row>\n              </Tab.Container>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default DocDashboard;\n\n//Check the functions of the contract\n// const gas = await contract.methods.addPatient(\"name\",\"hname\",\"contact\",\"faculty\",\"blue\").estimateGas();\n// const result = await contract.methods.addPatient(\"name\",\"hname\",\"contact\",\"faculty\",\"blue\").send({from: currentAccount, gas: 1000000});\n// const gas = await contract.methods.addDoctor(\"name\",\"hname\",\"contact\",\"faculty\").estimateGas();\n// const result = await contract.methods.addDoctor(\"name\",\"hname\",\"contact\",\"faculty\").send({from: currentAccount, gas: 1000000}); // const gas = await contract.methods.grantAccess(\"0xAb5d5d8C5E257d35E41f955693b42d628C126A2E\").estimateGas();\n// const result = await contract.methods.grantAccess(\"0xc52Bb0B6A662859B2E182524585b2F0a676F7823\").send({from: currentAccount,gas:1000000});\n// console.log(result)\n// const gas = await contract.methods.grantAccess(\"0xAb5d5d8C5E257d35E41f955693b42d628C126A2E\").estimateGas();\n// const result = await contract.methods.grantAccess(\"0xc52Bb0B6A662859B2E182524585b2F0a676F7823\").send({from: currentAccount,gas:1000000});\n// console.log(result)\n"]},"metadata":{},"sourceType":"module"}