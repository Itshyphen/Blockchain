{"ast":null,"code":"var _jsxFileName = \"/home/ranju/location/meDossier/frontend/src/pages/render.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { Switch, Route, Router } from \"react-router-dom\";\nimport Register from './home';\nimport getWeb3 from '../getWeb3';\nimport history from './history';\nimport Patient from './patients_dashboard';\nimport DocDashboard from './doctor_dashboard';\nimport { CONTRACT_ADDRESS, ABI } from \"../config.js\";\nimport Verifier from \"./registrer_dashboard\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Render() {\n  _s();\n\n  const [currentAccount, setCurrentAccount] = useState('');\n  const [contract, setContract] = useState({});\n  const [user, setUser] = useState([]);\n  const [doctors, setDoctors] = useState([]);\n  const [doctor, setDoctor] = useState([]);\n\n  const getWeb3Data = async () => {\n    try {\n      //obtain web3 from getWeb3\n      const web3 = await getWeb3(); //obtain the accounts\n\n      const accounts = await web3.eth.getAccounts();\n      console.log(accounts); //initialize contract\n\n      const instance = await new web3.eth.Contract(ABI, CONTRACT_ADDRESS);\n      setCurrentAccount(accounts[0]);\n      setContract({ ...instance\n      });\n    } catch (error) {\n      alert(\"Cannot load web3 ,contract. Consult console for details\");\n      console.log(error);\n    }\n  }; //Register Patient\n\n\n  const patientRegister = async (name, phone, gender, dob, blood) => {\n    try {\n      console.log(name, phone, gender, dob, blood);\n      console.log(currentAccount);\n      await contract.methods.addPatient(name, phone, gender, dob, blood).send({\n        from: currentAccount,\n        gas: 1000000\n      }); // await getWeb3Data();\n    } catch (error) {\n      console.log(error);\n    }\n  }; //Register/Add Doctor\n\n\n  const doctorRegister = async (name, hname, contact, faculty, license) => {\n    try {\n      console.log(name, hname, contact, faculty);\n      const result = await contract.methods.addDoctor(name, hname, contact, faculty, license).send({\n        from: currentAccount,\n        gas: 1000000\n      }); // await getWeb3Data();\n    } catch (error) {\n      console.log(error);\n    }\n  }; //Handle  patient Login\n\n\n  const handlelogin = async () => {\n    localStorage.setItem('currentAccount', currentAccount);\n    const result = await contract.methods.user(currentAccount).call({\n      from: currentAccount\n    });\n    console.log(result);\n\n    if (result == 0) {\n      try {\n        console.log(\"success\");\n        const registered = await contract.methods.isRegistered(currentAccount).call({\n          from: currentAccount\n        });\n\n        if (registered) {\n          await contract.methods.doctorLogin().send({\n            from: currentAccount,\n            gas: 1000000\n          });\n        } // await contract.methods.doctorLogin().send({from:currentAccount,gas:1000000})\n\n\n        const doctor = await contract.methods.getDoctorByAddress(currentAccount).call({\n          from: currentAccount\n        });\n        setUser(doctor);\n        localStorage.setItem('docname', doctor.name);\n        localStorage.setItem('faculty', doctor.faculty);\n        localStorage.setItem('contact', doctor.contact);\n        localStorage.setItem('isApproved', doctor.isApproved);\n        localStorage.setItem('license', doctor.licenseno);\n        localStorage.setItem('hname', doctor.hname);\n        console.log(doctor);\n        history.push('/doctor_dashboard'); // }\n      } catch (error) {\n        console.error(error); // alert(error)\n\n        alert(\"No records found\");\n      }\n    } else if (result == 1) {\n      try {\n        console.log(\"sucess\");\n        const patient = await contract.methods.getPatientDetails(currentAccount).call({\n          from: currentAccount\n        });\n        setUser(patient);\n        console.log(patient); // if(patient.length!==0){\n        // getPatientRecord();\n\n        localStorage.setItem('name', patient._name);\n        localStorage.setItem('phone', patient._phone);\n        localStorage.setItem('dob', patient._dob);\n        localStorage.setItem('bloodgroup', patient._bloodgroup);\n        localStorage.setItem('gender', patient._gender); // localStorage.setItem('hname',doctor.hname)\n\n        history.push('/patient'); // }\n      } catch (error) {\n        console.error(error); // alert(error)\n\n        alert(\"No records found\");\n      }\n    } else if (result == 2) {\n      getDoctor();\n      history.push('/Registration_office');\n    } else {\n      alert(\"User not registered!\");\n    }\n  }; //get the doctors registered by government\n\n\n  const getDoctor = async () => {\n    try {\n      const doctorlength = await contract.methods.getdoctorlist().call();\n      console.log(doctorlength);\n      const doctorlist = [];\n\n      for (let i = 0; i < doctorlength; i++) {\n        const doctors = await contract.methods.getDoctorbyId(i).call();\n        console.log(doctors);\n        doctorlist.push(doctors);\n      }\n\n      setDoctors(doctorlist);\n      await getWeb3Data();\n    } catch (error) {\n      console.log(error);\n    }\n  }; //Patient grant Access to doctor\n\n\n  const grantAccess = async doctor => {\n    try {\n      await contract.methods.grantAccess(doctor).send({\n        from: currentAccount,\n        gas: 1000000\n      });\n    } catch (error) {\n      console.error(error);\n    }\n  }; //Patient revoke access from doctor\n\n\n  const revokeAccess = async doctor => {\n    try {\n      console.log(doctor);\n      await contract.methods.revoke_access(doctor).send({\n        from: currentAccount,\n        gas: 1000000\n      });\n    } catch (error) {\n      console.error(error);\n      alert(error);\n    }\n  }; //Handle Doctor Login\n\n\n  const dhandlelogin = async () => {\n    try {\n      console.log(\"success\");\n      const doctor = await contract.methods.getDoctorByAddress(currentAccount).call({\n        from: currentAccount\n      });\n      setUser(doctor);\n      console.log(doctor);\n      history.push('/doctor_dashboard'); // }\n    } catch (error) {\n      console.error(error); // alert(error)\n\n      alert(\"No records found\");\n    }\n  };\n\n  useEffect(() => {\n    getWeb3Data();\n  }, []);\n  return (\n    /*#__PURE__*/\n    // <div className =\"Main\">\n    _jsxDEV(Router, {\n      history: history,\n      children: /*#__PURE__*/_jsxDEV(Switch, {\n        children: [/*#__PURE__*/_jsxDEV(Route, {\n          path: \"/\",\n          exact: true,\n          children: /*#__PURE__*/_jsxDEV(Register, {\n            patientRegister: patientRegister,\n            doctorRegister: doctorRegister,\n            handlelogin: handlelogin,\n            dhandlelogin: dhandlelogin\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/patient\",\n          children: /*#__PURE__*/_jsxDEV(Patient, {\n            patient: user,\n            grantAccess: grantAccess,\n            revokeAccess: revokeAccess,\n            contract: contract,\n            currentAccount: currentAccount // getPatientRecord ={getPatientRecord}\n            // records ={records}\n\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/doctor_dashboard\",\n          children: /*#__PURE__*/_jsxDEV(DocDashboard, {\n            doctor: user,\n            contract: contract,\n            currentAccount: currentAccount\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/Registration_office\",\n          children: /*#__PURE__*/_jsxDEV(Verifier, {\n            owner: user,\n            contract: contract,\n            currentAccount: currentAccount,\n            getDoctor: getDoctor // getunverifieddoctor={getunverifieddoctor}\n            // unverifieddoctor ={doctor}\n            ,\n            doctors: doctors // verifydoctor ={verifydoctor}\n\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 9\n    }, this) // </div>\n\n  );\n}\n\n_s(Render, \"PGU7zkJbbrtrlVyQw3Z+3D2x/5w=\");\n\n_c = Render;\nexport default Render;\n\nvar _c;\n\n$RefreshReg$(_c, \"Render\");","map":{"version":3,"sources":["/home/ranju/location/meDossier/frontend/src/pages/render.js"],"names":["React","useState","useEffect","Switch","Route","Router","Register","getWeb3","history","Patient","DocDashboard","CONTRACT_ADDRESS","ABI","Verifier","Render","currentAccount","setCurrentAccount","contract","setContract","user","setUser","doctors","setDoctors","doctor","setDoctor","getWeb3Data","web3","accounts","eth","getAccounts","console","log","instance","Contract","error","alert","patientRegister","name","phone","gender","dob","blood","methods","addPatient","send","from","gas","doctorRegister","hname","contact","faculty","license","result","addDoctor","handlelogin","localStorage","setItem","call","registered","isRegistered","doctorLogin","getDoctorByAddress","isApproved","licenseno","push","patient","getPatientDetails","_name","_phone","_dob","_bloodgroup","_gender","getDoctor","doctorlength","getdoctorlist","doctorlist","i","getDoctorbyId","grantAccess","revokeAccess","revoke_access","dhandlelogin"],"mappings":"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","sourcesContent":["\nimport React,{useState ,useEffect} from \"react\";\nimport { Switch ,Route ,Router} from \"react-router-dom\";\nimport Register from './home';\nimport getWeb3 from '../getWeb3';\nimport history from './history';\nimport Patient from './patients_dashboard';\nimport DocDashboard from './doctor_dashboard';\nimport { CONTRACT_ADDRESS, ABI } from \"../config.js\";\nimport Verifier from \"./registrer_dashboard\";\n\n\nfunction Render() {\n  \n const[currentAccount,setCurrentAccount]= useState('');\n const[contract, setContract] = useState({});\n const[user,setUser] = useState([]);\n const[doctors,setDoctors] = useState([]);\n const[doctor,setDoctor] = useState([]);\n\n const getWeb3Data = async()=>{\n   try{\n      //obtain web3 from getWeb3\n      const web3 = await getWeb3();\n      //obtain the accounts\n      const accounts = await web3.eth.getAccounts();\n      console.log(accounts);\n//initialize contract\n      const instance = await new web3.eth.Contract(ABI, CONTRACT_ADDRESS);\n      setCurrentAccount(accounts[0]);\n      setContract({...instance});\n   }\n   catch(error){\n     alert(\"Cannot load web3 ,contract. Consult console for details\");\n     console.log(error);\n   }\n }\n  //Register Patient\n  const patientRegister = async(name,phone,gender,dob,blood)=>{\n    try{\n      console.log(name,phone,gender,dob,blood);\n      console.log(currentAccount);\n      await contract.methods.addPatient(name,phone,gender,dob,blood).send({from:currentAccount,gas:1000000});\n      // await getWeb3Data();\n    }\n    catch(error){\n      console.log(error);\n    }\n  }\n  //Register/Add Doctor\n  const doctorRegister = async(name,hname,contact,faculty,license)=>{\n    try{\n      console.log(name,hname,contact,faculty);\n      const result = await contract.methods.addDoctor(name,hname,contact,faculty,license).send({from:currentAccount,gas:1000000});\n      // await getWeb3Data();\n\n    }\ncatch(error){\n  console.log(error);\n}\n  }\n  //Handle  patient Login\n  const handlelogin = async()=>{\n    localStorage.setItem('currentAccount',currentAccount)\n    const result = await contract.methods.user(currentAccount).call({from:currentAccount});\n    console.log(result);\n    if(result==0){\n      try{\n        console.log(\"success\");\n        const registered = await contract.methods.isRegistered(currentAccount).call({from:currentAccount});\n        if(registered){\n          await contract.methods.doctorLogin().send({from:currentAccount,gas:1000000})\n        }\n        // await contract.methods.doctorLogin().send({from:currentAccount,gas:1000000})\n        const doctor = await contract.methods.getDoctorByAddress(currentAccount).call({from:currentAccount});\n        setUser(doctor);\n        localStorage.setItem('docname',doctor.name)\n        localStorage.setItem('faculty',doctor.faculty)\n        localStorage.setItem('contact',doctor.contact)\n        localStorage.setItem('isApproved',doctor.isApproved)\n        localStorage.setItem('license',doctor.licenseno)\n        localStorage.setItem('hname',doctor.hname)\n        console.log(doctor)\n          history.push('/doctor_dashboard')\n        // }\n        \n      }\n      catch(error){\n        console.error(error);\n        // alert(error)\n        alert(\"No records found\")\n      }\n    }\n    else if(result==1){\n      try{\n        console.log(\"sucess\");\n        const patient = await contract.methods.getPatientDetails(currentAccount).call({from:currentAccount});\n        setUser(patient);\n        console.log(patient)\n        // if(patient.length!==0){\n          // getPatientRecord();\n         localStorage.setItem('name',patient._name)\n        localStorage.setItem('phone',patient._phone)\n        localStorage.setItem('dob',patient._dob)\n        localStorage.setItem('bloodgroup',patient._bloodgroup)\n        localStorage.setItem('gender',patient._gender)\n        // localStorage.setItem('hname',doctor.hname)\n  \n          history.push('/patient')\n        // }\n        \n      }\n      catch(error){\n        console.error(error);\n        // alert(error)\n        alert(\"No records found\")\n      }\n    }\n    else if(result==2) {\n      \n        getDoctor();\n        \n     \n        history.push('/Registration_office')\n  \n    }\n    else{\n      alert(\"User not registered!\")\n    }\n   \n  }\n\n  //get the doctors registered by government\n  const getDoctor = async()=>{\n    try{\n      const doctorlength =await contract.methods.getdoctorlist().call();\n      console.log(doctorlength);\n      const doctorlist =[];\n      for(let i=0;i<doctorlength;i++){\n          const doctors = await contract.methods.getDoctorbyId(i).call();\n          console.log(doctors);\n          doctorlist.push(doctors);\n      }\n      setDoctors(doctorlist);\n    await getWeb3Data();}\n    catch(error){\n      console.log(error);\n    }}\n//Patient grant Access to doctor\n  const grantAccess = async(doctor)=>{\n    try{\n      await contract.methods.grantAccess(doctor).send({from:currentAccount,gas:1000000})\n    }\n    catch(error){\n      console.error(error);\n    }\n  }\n  //Patient revoke access from doctor\n  const revokeAccess = async(doctor)=>{\n    try{\n      console.log(doctor)\n      await contract.methods.revoke_access(doctor).send({from:currentAccount,gas:1000000})\n    }\n    catch(error){\n      console.error(error);\n      alert(error);\n    }\n  }\n  \n  //Handle Doctor Login\n  const dhandlelogin = async()=>{\n    try{\n      console.log(\"success\");\n      const doctor = await contract.methods.getDoctorByAddress(currentAccount).call({from:currentAccount});\n      setUser(doctor);\n      console.log(doctor)\n        history.push('/doctor_dashboard')\n      // }\n      \n    }\n    catch(error){\n      console.error(error);\n      // alert(error)\n      alert(\"No records found\")\n    }\n  }\n  useEffect(()=>{\n    getWeb3Data();\n  },[]);\n  return (\n    \n      // <div className =\"Main\">\n        <Router history={history}>\n        <Switch>\n          <Route path ='/' exact>\n          <Register\n          patientRegister={patientRegister}\n          doctorRegister ={doctorRegister}\n          handlelogin ={handlelogin}\n          dhandlelogin ={dhandlelogin}\n\n          />\n          </Route>\n          <Route path ='/patient'>\n            <Patient\n            patient={user}\n            grantAccess ={grantAccess}\n            revokeAccess ={revokeAccess}\n            contract ={contract}\n            currentAccount ={currentAccount}\n            // getPatientRecord ={getPatientRecord}\n            // records ={records}\n            />\n          </Route>\n          <Route exact path = \"/doctor_dashboard\">\n          <DocDashboard \n          doctor = {user}\n          contract ={contract}\n          currentAccount ={currentAccount}\n          />\n          \n          </Route>\n          <Route exact path = \"/Registration_office\">\n          <Verifier \n          owner = {user}\n          contract ={contract}\n          currentAccount ={currentAccount}\n          getDoctor ={getDoctor}\n          // getunverifieddoctor={getunverifieddoctor}\n          // unverifieddoctor ={doctor}\n          doctors={doctors}\n          // verifydoctor ={verifydoctor}\n          />\n          \n          </Route>\n          \n          </Switch>\n          </Router>\n  \n      // </div>\n    )\n  }\n\nexport default Render"]},"metadata":{},"sourceType":"module"}