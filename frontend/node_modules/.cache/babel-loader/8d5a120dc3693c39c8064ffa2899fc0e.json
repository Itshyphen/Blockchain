{"ast":null,"code":"import _regeneratorRuntime from\"/home/ranju/location/meDossier/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/ranju/location/meDossier/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/ranju/location/meDossier/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import Web3 from\"web3\";import{withStyles,makeStyles}from\"@material-ui/core/styles\";import{Table,TableHead,TableContainer,TableBody,TableCell,TableRow,Card,Box,Paper,TextField,Button}from\"@material-ui/core\";import{Tabs,Tab,Row,Col,Nav,Navbar}from\"react-bootstrap\";import\"./general.css\";import logo from\"./logo.png\";import{CONTRACT_ADDRESS,ABI}from\"../config.js\";import history from\"./history\";//main dashboard\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Verifier(props){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),recordlen=_useState2[0],setRecordLength=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),records=_useState4[0],setRecords=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),dname=_useState6[0],setDname=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),license=_useState8[0],setLicense=_useState8[1];var currentAccount=localStorage.getItem(\"currentAccount\");var isDoctor=localStorage.getItem(\"isdoctor\");var ispatient=localStorage.getItem(\"ispatient\");var web3=new Web3(Web3.givenProvider);var contract=new web3.eth.Contract(ABI,CONTRACT_ADDRESS);var Register=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return contract.methods.registerDoctor(dname,license).send({from:currentAccount,gas:1000000});case 3:_context.next=9;break;case 5:_context.prev=5;_context.t0=_context[\"catch\"](0);console.log(_context.t0);alert(\"Error in Registration\");case 9:case\"end\":return _context.stop();}}},_callee,null,[[0,5]]);}));return function Register(_x){return _ref.apply(this,arguments);};}();var getDoctorsList=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var rlen,record,i,licn,result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return contract.methods.getRegisteredDoctorslength().call();case 3:rlen=_context2.sent;console.log(\"record length\"+rlen);setRecordLength(rlen);record=[];i=0;case 8:if(!(i<recordlen)){_context2.next=27;break;}_context2.next=11;return contract.methods.getRegisteredDoctorsList(i).call({from:currentAccount});case 11:licn=_context2.sent;console.log(licn);_context2.prev=13;_context2.next=16;return contract.methods.getDoctorbyLicense(licn).call({from:currentAccount});case 16:result=_context2.sent;console.log(result);record.push({dname:result.name,hname:result.hospital,faculty:result._faculty,license:licn});_context2.next=24;break;case 21:_context2.prev=21;_context2.t0=_context2[\"catch\"](13);record.push({dname:\"No account/Not Logged in After Registration\",hname:\"----\",faculty:\"----\",license:licn});case 24:i++;_context2.next=8;break;case 27:console.log(record);setRecords(record);_context2.next=34;break;case 31:_context2.prev=31;_context2.t1=_context2[\"catch\"](0);console.log(_context2.t1);case 34:case\"end\":return _context2.stop();}}},_callee2,null,[[0,31],[13,21]]);}));return function getDoctorsList(_x2){return _ref2.apply(this,arguments);};}();useEffect(function(){getDoctorsList();// getDoctorDetails();\n},[recordlen]);var useStyles=makeStyles({table:{minWidth:700},root:{width:\"100%\"},container:{maxHeight:440}});var classes=useStyles();//Styling for table cell\nvar StyledTableCell=withStyles(function(theme){return{head:{backgroundColor:theme.palette.info.main,color:theme.palette.common.blue},body:{fontSize:14}};})(TableCell);var StyledTableRow=withStyles(function(theme){return{root:{\"&:nth-of-type(odd)\":{backgroundColor:theme.palette.action.hover}}};})(TableRow);if(!currentAccount){history.push(\"/\");}if(isDoctor==\"true\"){history.push(\"/doctor_dashboard\");}if(ispatient==\"true\"){history.push(\"/patient\");}return/*#__PURE__*/_jsxs(\"div\",{className:\"Registrer\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"nav_main\",children:[getDoctorsList,/*#__PURE__*/_jsxs(Navbar// bg=\"light\"\n,{color:\"purple\",expand:\"lg\",children:[/*#__PURE__*/_jsx(\"img\",{src:logo,width:\"120\",height:\"40\",className:\"d-inline-block align-top\"}),/*#__PURE__*/_jsx(Navbar.Toggle,{}),/*#__PURE__*/_jsxs(Navbar.Collapse,{className:\"justify-content-end\",children:[/*#__PURE__*/_jsxs(Nav.Link,{a:true,href:\"/registration\",children:[\" \",/*#__PURE__*/_jsxs(\"i\",{class:\"far fa-1x fa-user-circle\",children:[\" \",/*#__PURE__*/_jsx(\"b\",{children:\"License Registration Office\"}),\" \"]}),\" \"]}),/*#__PURE__*/_jsxs(Button,{onClick:function onClick(e){return props.logout();},children:[\" \",/*#__PURE__*/_jsx(\"i\",{class:\"fas fa-1x fa-sign-out-alt\"}),\" Log out\"]})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"tab-wrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container-fluid\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-12\",children:/*#__PURE__*/_jsx(Tab.Container,{defaultActiveKey:\"doctors_list\",children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{sm:3,children:/*#__PURE__*/_jsxs(Nav,{variant:\"pills\",className:\"flex-column\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Nav.Item,{children:[/*#__PURE__*/_jsx(Nav.Link,{eventKey:\"doctors_list\",children:/*#__PURE__*/_jsx(\"b\",{children:\" Registered Doctors\"})}),/*#__PURE__*/_jsx(\"hr\",{})]})}),/*#__PURE__*/_jsxs(Nav.Item,{children:[/*#__PURE__*/_jsxs(Nav.Link,{eventKey:\"new_registration\",children:[\" \",/*#__PURE__*/_jsx(\"b\",{children:\"New Registration \"})]}),/*#__PURE__*/_jsx(\"hr\",{})]})]})}),/*#__PURE__*/_jsx(Col,{sm:9,children:/*#__PURE__*/_jsxs(Tab.Content,{children:[/*#__PURE__*/_jsxs(Tab.Pane,{eventKey:\"doctors_list\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"Details\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Welcome to the MeDossier\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h5\",{children:\"The Following Doctors are Registered\"})]}),/*#__PURE__*/_jsx(\"div\",{class:\"small-card\",children:/*#__PURE__*/_jsx(\"div\",{className:\"table\",children:/*#__PURE__*/_jsx(Box,{mt:3,mb:3,children:/*#__PURE__*/_jsx(Paper,{className:classes.root,children:/*#__PURE__*/_jsx(TableContainer,{className:classes.container,children:/*#__PURE__*/_jsxs(Table,{className:classes.table,size:\"small\",stickyHeader:true,\"aria-label\":\"sticky table\",children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(StyledTableCell,{children:\"License\"}),/*#__PURE__*/_jsx(StyledTableCell,{children:\"Name\"}),/*#__PURE__*/_jsx(StyledTableCell,{children:\"Faculty\"}),/*#__PURE__*/_jsx(StyledTableCell,{children:\"Working Hospital\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:records.map(function(record,index){return/*#__PURE__*/_jsxs(StyledTableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:record[\"license\"]}),/*#__PURE__*/_jsx(TableCell,{children:record[\"dname\"]}),/*#__PURE__*/_jsx(TableCell,{children:record[\"faculty\"]}),/*#__PURE__*/_jsx(TableCell,{children:record[\"hname\"]})]},index);})})]})})})})})})]}),/*#__PURE__*/_jsxs(Tab.Pane,{eventKey:\"new_registration\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"Details\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Welcome to the MeDossier\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h5\",{children:\"New Doctor Registration\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"small card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Register Doctor\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(TextField,{id:\"outlined-basic full-width\",fullWidth:true,variant:\"outlined\",margin:\"normal\",label:\"License Number\"// style ={{height:60}}\n,onChange:function onChange(e){return setLicense(e.target.value);}}),/*#__PURE__*/_jsx(TextField,{id:\"outlined-basic\",fullWidth:true,variant:\"outlined\",margin:\"normal\",label:\"Doctor Name\",onChange:function onChange(e){return setDname(e.target.value);}}),/*#__PURE__*/_jsx(Button,{onClick:Register,variant:\"contained\",fullWidth:true,margin:\"normal\",style:{backgroundColor:\"#0080FF\",color:\"floralwhite\"},children:\"Register\"})]})]})]})]})})]})})})})})})]});}export default Verifier;","map":{"version":3,"sources":["/home/ranju/location/meDossier/frontend/src/pages/registrer_dashboard.js"],"names":["React","useState","useEffect","Web3","withStyles","makeStyles","Table","TableHead","TableContainer","TableBody","TableCell","TableRow","Card","Box","Paper","TextField","Button","Tabs","Tab","Row","Col","Nav","Navbar","logo","CONTRACT_ADDRESS","ABI","history","Verifier","props","recordlen","setRecordLength","records","setRecords","dname","setDname","license","setLicense","currentAccount","localStorage","getItem","isDoctor","ispatient","web3","givenProvider","contract","eth","Contract","Register","e","methods","registerDoctor","send","from","gas","console","log","alert","getDoctorsList","getRegisteredDoctorslength","call","rlen","record","i","getRegisteredDoctorsList","licn","getDoctorbyLicense","result","push","name","hname","hospital","faculty","_faculty","useStyles","table","minWidth","root","width","container","maxHeight","classes","StyledTableCell","theme","head","backgroundColor","palette","info","main","color","common","blue","body","fontSize","StyledTableRow","action","hover","logout","map","index","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport Web3 from \"web3\";\nimport { withStyles, makeStyles } from \"@material-ui/core/styles\";\nimport {\n  Table,\n  TableHead,\n  TableContainer,\n  TableBody,\n  TableCell,\n  TableRow,\n  Card,\n  Box,\n  Paper,\n  TextField,\n  Button,\n} from \"@material-ui/core\";\nimport { Tabs, Tab, Row, Col, Nav, Navbar } from \"react-bootstrap\";\nimport \"./general.css\";\nimport logo from \"./logo.png\";\nimport { CONTRACT_ADDRESS, ABI } from \"../config.js\";\nimport history from \"./history\";\n\n//main dashboard\nfunction Verifier(props) {\n  const [recordlen, setRecordLength] = useState(0);\n  const [records, setRecords] = useState([]);\n  const [dname, setDname] = useState(\"\");\n  const [license, setLicense] = useState(0);\n\n  const currentAccount = localStorage.getItem(\"currentAccount\");\n  const isDoctor = localStorage.getItem(\"isdoctor\");\n  const ispatient = localStorage.getItem(\"ispatient\");\n\n  const web3 = new Web3(Web3.givenProvider);\n  const contract = new web3.eth.Contract(ABI, CONTRACT_ADDRESS);\n\n  const Register = async (e) => {\n    try {\n      //whether doctor is authorized or not\n\n      await contract.methods\n        .registerDoctor(dname, license)\n        .send({ from: currentAccount, gas: 1000000 });\n    } catch (error) {\n      console.log(error);\n      alert(\"Error in Registration\");\n    }\n  };\n\n  const getDoctorsList = async (e) => {\n    try {\n      //check whether doctor is authorized or not\n\n      //get the number of records\n      const rlen = await contract.methods.getRegisteredDoctorslength().call();\n      console.log(\"record length\" + rlen);\n      setRecordLength(rlen);\n\n      let record = [];\n      for (var i = 0; i < recordlen; i++) {\n        const licn = await contract.methods\n          .getRegisteredDoctorsList(i)\n          .call({ from: currentAccount });\n        console.log(licn);\n        try {\n          const result = await contract.methods\n            .getDoctorbyLicense(licn)\n            .call({ from: currentAccount });\n          console.log(result);\n          record.push({\n            dname: result.name,\n            hname: result.hospital,\n            faculty: result._faculty,\n            license: licn,\n          });\n        } catch {\n          record.push({\n            dname: \"No account/Not Logged in After Registration\",\n            hname: \"----\",\n            faculty: \"----\",\n            license: licn,\n          });\n        }\n      }\n      console.log(record);\n      setRecords(record);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  useEffect(() => {\n    getDoctorsList();\n    // getDoctorDetails();\n  }, [recordlen]);\n\n  const useStyles = makeStyles({\n    table: {\n      minWidth: 700,\n    },\n    root: {\n      width: \"100%\",\n    },\n    container: {\n      maxHeight: 440,\n    },\n  });\n  const classes = useStyles();\n\n  //Styling for table cell\n  const StyledTableCell = withStyles((theme) => ({\n    head: {\n      backgroundColor: theme.palette.info.main,\n      color: theme.palette.common.blue,\n    },\n    body: {\n      fontSize: 14,\n    },\n  }))(TableCell);\n\n  const StyledTableRow = withStyles((theme) => ({\n    root: {\n      \"&:nth-of-type(odd)\": {\n        backgroundColor: theme.palette.action.hover,\n      },\n    },\n  }))(TableRow);\n\n  if (!currentAccount) {\n    history.push(\"/\");\n  }\n  if (isDoctor == \"true\") {\n    history.push(\"/doctor_dashboard\");\n  }\n\n  if (ispatient == \"true\") {\n    history.push(\"/patient\");\n  }\n\n  return (\n    <div className=\"Registrer\">\n      <div className=\"nav_main\">\n        {getDoctorsList}\n        <Navbar\n          // bg=\"light\"\n          color=\"purple\"\n          expand=\"lg\"\n        >\n          <img\n            src={logo}\n            width=\"120\"\n            height=\"40\"\n            className=\"d-inline-block align-top\"\n          />\n          {/* patient */}\n          <Navbar.Toggle />\n          <Navbar.Collapse className=\"justify-content-end\">\n            <Nav.Link a href=\"/registration\">\n              {\" \"}\n              <i class=\"far fa-1x fa-user-circle\">\n                {\" \"}\n                <b>License Registration Office</b>{\" \"}\n              </i>{\" \"}\n            </Nav.Link>\n            <Button onClick={(e) => props.logout()}>\n              {\" \"}\n              <i class=\"fas fa-1x fa-sign-out-alt\" /> Log out\n            </Button>\n          </Navbar.Collapse>\n        </Navbar>\n      </div>\n      {/* End Navbar */}\n\n      {/* Side Tabs */}\n      <div className=\"tab-wrapper\">\n        <div className=\"container-fluid\">\n          <div className=\"row\">\n            <div className=\"col-sm-12\">\n              <Tab.Container defaultActiveKey=\"doctors_list\">\n                <Row>\n                  <Col sm={3}>\n                    <Nav variant=\"pills\" className=\"flex-column\">\n                      <div>\n                        <Nav.Item>\n                          <Nav.Link eventKey=\"doctors_list\">\n                            <b> Registered Doctors</b>\n                          </Nav.Link>\n                          <hr />\n                        </Nav.Item>\n                      </div>\n                      <Nav.Item>\n                        <Nav.Link eventKey=\"new_registration\">\n                          {\" \"}\n                          <b>New Registration </b>\n                        </Nav.Link>\n                        <hr />\n                      </Nav.Item>\n                    </Nav>\n                  </Col>\n                  <Col sm={9}>\n                    <Tab.Content>\n                      {/* Doctors Details */}\n                      <Tab.Pane eventKey=\"doctors_list\">\n                        <div className=\"Details\">\n                          <h3>Welcome to the MeDossier</h3>\n                          <br />\n                          <h5>The Following Doctors are Registered</h5>\n                        </div>\n\n                        {/* Registered Doctor List */}\n                        <div class=\"small-card\">\n                          <div className=\"table\">\n                            <Box mt={3} mb={3}>\n                              <Paper className={classes.root}>\n                                <TableContainer className={classes.container}>\n                                  <Table\n                                    className={classes.table}\n                                    size={\"small\"}\n                                    stickyHeader\n                                    aria-label=\"sticky table\"\n                                  >\n                                    <TableHead>\n                                      <TableRow>\n                                        <StyledTableCell>\n                                          License\n                                        </StyledTableCell>\n                                        <StyledTableCell>Name</StyledTableCell>\n                                        <StyledTableCell>\n                                          Faculty\n                                        </StyledTableCell>\n                                        <StyledTableCell>\n                                          Working Hospital\n                                        </StyledTableCell>\n                                      </TableRow>\n                                    </TableHead>\n                                    <TableBody>\n                                      {records.map((record, index) => {\n                                        return (\n                                          <StyledTableRow key={index}>\n                                            <TableCell>\n                                              {record[\"license\"]}\n                                            </TableCell>\n                                            <TableCell>\n                                              {record[\"dname\"]}\n                                            </TableCell>\n                                            <TableCell>\n                                              {record[\"faculty\"]}\n                                            </TableCell>\n                                            <TableCell>\n                                              {record[\"hname\"]}\n                                            </TableCell>\n                                          </StyledTableRow>\n                                        );\n                                      })}\n                                    </TableBody>\n                                  </Table>\n                                </TableContainer>\n                              </Paper>\n                            </Box>\n                          </div>\n                        </div>\n                      </Tab.Pane>\n\n                      <Tab.Pane eventKey=\"new_registration\">\n                        <div className=\"Details\">\n                          <h3>Welcome to the MeDossier</h3>\n                          <br />\n                          <h5>New Doctor Registration</h5>\n                        </div>\n                        <div className=\"small card\">\n                          <h3>Register Doctor</h3>\n                          <hr></hr>\n                          <form>\n                            <TextField\n                              id=\"outlined-basic full-width\"\n                              fullWidth={true}\n                              variant=\"outlined\"\n                              margin=\"normal\"\n                              label=\"License Number\"\n                              // style ={{height:60}}\n                              onChange={(e) => setLicense(e.target.value)}\n                            />\n                            <TextField\n                              id=\"outlined-basic\"\n                              fullWidth={true}\n                              variant=\"outlined\"\n                              margin=\"normal\"\n                              label=\"Doctor Name\"\n                              onChange={(e) => setDname(e.target.value)}\n                            />\n\n                            <Button\n                              onClick={Register}\n                              variant=\"contained\"\n                              fullWidth\n                              margin=\"normal\"\n                              style={{\n                                backgroundColor: \"#0080FF\",\n                                color: \"floralwhite\",\n                              }}\n                            >\n                              Register\n                            </Button>\n                          </form>\n                        </div>\n                      </Tab.Pane>\n                    </Tab.Content>\n                  </Col>\n                </Row>\n              </Tab.Container>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Verifier;\n"]},"metadata":{},"sourceType":"module"}